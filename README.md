# 病棟勤務表 自動作成システム

看護師の病棟勤務表を自動生成するWebアプリケーションです。

## 機能

- エクセルファイル（`.xlsx`）のアップロード・解析
- 委員会予定・希望休を維持したままシフトを自動生成
- 生成結果のプレビュー表示（色分け付き）
- 気に入らない場合は「再作成」で何度でも再生成可能
- 完成した勤務表をエクセルファイルとしてダウンロード

## シフト生成ルール

1. **夜勤リーダー配置** — 毎日1人のリーダーを夜勤に割り当て
2. **夜勤ペア配置** — 毎日1人のペアを夜勤に割り当て
3. **日勤リーダー配置** — 毎日少なくとも1人のリーダーが日勤
4. **日勤メンバー配置** — 必要人数を満たすよう日勤を配置
5. **夜勤3日セット** — 夜勤 → 明け → 公休

## エクセルフォーマット

| 職員番号 | 1 | 2 | 3 | 4 | ... | 31 |
|---------|---|---|---|---|-----|-----|
| 001     |   | 委 |   |   |     |     |
| 002     | 希 |   |   |   |     |     |
| ...     |   |   |   |   |     |     |

- 1行目: ヘッダー（日付）
- A列: 職員番号（上からリーダー順に並べる）
- 既存の値（委、希など）は固定として保持されます

## セットアップ

### ローカル実行

```bash
# Python 3.11+ が必要です

# 仮想環境の作成
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 依存パッケージのインストール
pip install -r requirements.txt

# サーバー起動
python main.py
```

ブラウザで http://localhost:8000 にアクセスしてください。

### Render へのデプロイ

1. GitHubにリポジトリをプッシュ
2. [Render](https://render.com) でアカウント作成
3. 「New Web Service」からリポジトリを接続
4. `render.yaml` が自動検出されます
5. デプロイ完了後、提供されたURLにアクセス

## 設定項目

| 設定 | 説明 | デフォルト |
|------|------|-----------|
| 日勤リーダー可能人数 | 上から何人目までが日勤リーダー可能か | 5 |
| 夜勤リーダー可能人数 | 上から何人目までが夜勤リーダー可能か | 3 |
| 夜勤可能人数 | 上から何人目までが夜勤可能か | 15 |
| 1日の日勤必要人数 | 日勤に必要な人数 | 7 |
| 月間夜勤上限 | 1人あたりの月間夜勤回数上限 | 4 |
| 公休日数 | 1人あたりの月間公休日数 | 8 |

## 技術スタック

- **バックエンド**: Python / FastAPI
- **フロントエンド**: HTML / Tailwind CSS / JavaScript
- **エクセル処理**: openpyxl
- **デプロイ**: Render
